[{"content":"0x1、概述 在研究学习Windows程序逆向的时候，遇到文件加解密。加解密比价贴合实际工作，特别是APT的二次下载样本、shellcode、C\u0026amp;C等又如键盘记录、屏幕截图等，网络传输数据流都有很大概率是加密的。\n如下面恶意代码，从自身资源节中释放加密文件，再将释放的文件就行解密，最后将解密出来的pe文件注入到svchost进程中。\n0x2、加解密 一般简单的加密算法识别，可以从文件结构入手，其中最重要的就是文件头，文件头是已知的数据，可以使用文件头进行算法猜测或者爆破。\nbaes64：填充字符，如果输入数据的长度不是 3 的倍数，Base64 编码会在编码后的结果末尾添加**一个或两个等号（=）**作为填充字符，以确保编码后的字符串长度是 4 的倍数，另外样本中可能会有标准Base64表。 xor：异或加密只需要一个字符即可，单字节加密可通过暴力破解来解密（暴力破解识别） 凯撒：古老且简单的算法，字符串向右移动字符，偏移量是一个整数，在 0 到 25 之间，简单爆破可解。 。。。。。。 因为涉及到解密，样本中使用对称加密算法居多，加密与解密的密钥相同，常见的对称加密算法是AES和DES。\nAES：AES 是块加密算法，每次处理 128 位（16 字节）的数据块。数据块被分为多个 4x4 的字节矩阵进行处理。x[j]=si%4] 循环4次 s[i][j]=x[j] 循环4次 整体循环4次(行位移）\n非对称加密是指加密和解密使用密钥不同，一般使用公钥加密，私钥解密，常用openssl。在样本分析中只有提取私钥才能解密文件或者网络流量。\nRSA：生成的私钥文件默认开头为“\u0026mdash;\u0026ndash;BEGIN OPENSSH PRIVATE KEY\u0026mdash;\u0026ndash;”，结尾为“\u0026mdash;\u0026ndash;END OPENSSH PRIVATE KEY\u0026mdash;\u0026ndash;”，内容可能使用**=**号补位\n0x3、解密方法 案列\n看一个Windows程序样本，抓包发现它接收指令，然后返回加密的数据到cc，解析它的加解密算法。\n使用工具\nIDA pro静态，静态分析反编译工具（插件工具如FindCrypt2、KANAL） Ollydebug，动态分析反编译工具 步骤\n1、使用PEID的KANAL插件查看发现AES加密特征（RIJNDAEL算法就是AES）\n2、跳转面的地址00401E95所在的函数，发现大量计算，代码中出现 4*的计算，疑似AES加密块\n3、交叉应用发现，该函数在main中被调用，调用push将key压栈，所以AES加密key就是16字节的字符串\u0026quot;ijklmnopqrstuvwx\u0026quot;\n4、main函数，初始化网络与cc建立连接socks，由sub_401AC2加密，sub_4015B7主要实现管道的输入和输出、进程线程创建。\n编写流量解密脚本，拷贝流量中返回的载荷\n脚本如下，但解出来编码不知道为什么很奇怪，使用x32dbg调式看看\n另外还有其他方法，加密函数处下断点，找到缓冲区的数据buf，然后将它们提取出来，利用winHex进行复制另存到一个文件中，然后再与加密后的数据进行对比，后面再研究看看。\n","permalink":"https://dshh-sec.github.io/posts/%E6%A0%B7%E6%9C%AC%E8%A7%A3%E5%AF%86/","summary":"\u003ch2 id=\"0x1概述\"\u003e0x1、概述\u003c/h2\u003e\n\u003cp\u003e在研究学习Windows程序逆向的时候，遇到文件加解密。加解密比价贴合实际工作，特别是APT的二次下载样本、shellcode、C\u0026amp;C等又如键盘记录、屏幕截图等，网络传输数据流都有很大概率是加密的。\u003c/p\u003e","title":"流量、样本解密"},{"content":"itunes backup\n手机输入密码新人设备，信任文件保存在电脑中\n注意：信任文件会因版本升级、系统重启等因素失效\n建议使用加密备份，获取的信息更加全面\n备份完成后的存储路径%USERPROFILE%\\Apple\\MobileSync\\Backup下的设备UDID文件夹中。\nmvt（Mobile Verification Toolkit）\nOxygen Forensic Suite，支持对手机基本信息、SIM卡信息、联系人列表、组信息、快速拨号、通话记录、短消息、短信中心时间戳、日历、待办事项、文本便签、照片、视频、音频、LifeBlog 数据（所有活动，包含地理信息）、Java 程序、手机内存和闪存卡中的文件系统数据、GPRS 和 Wi-Fi 使用记录、录音文件等信息的获取与恢复。该工具也可以针对非智能手机、智能手机、平板的逻辑分析。\ncheckm8， iOS 设备漏洞半越狱进行取证，但支持版本比较旧\n","permalink":"https://dshh-sec.github.io/posts/%E6%89%8B%E6%9C%BA%E5%8F%96%E8%AF%81/","summary":"\u003cp\u003eitunes backup\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"https://image-1253434595.cos.ap-chengdu.myqcloud.com/img/202409202201620.png\" alt=\"img\"  /\u003e\r\n\u003c/p\u003e\n\u003cp\u003e手机输入密码新人设备，信任文件保存在电脑中\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"https://image-1253434595.cos.ap-chengdu.myqcloud.com/img/202409202201169.png\" alt=\"img\"  /\u003e\r\n\u003c/p\u003e\n\u003cp\u003e注意：信任文件会因版本升级、系统重启等因素失效\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"https://image-1253434595.cos.ap-chengdu.myqcloud.com/img/202409202201084.png\" alt=\"img\"  /\u003e\r\n\u003c/p\u003e\n\u003cp\u003e建议使用加密备份，获取的信息更加全面\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"https://image-1253434595.cos.ap-chengdu.myqcloud.com/img/202409202201006.png\" alt=\"img\"  /\u003e\r\n\u003c/p\u003e\n\u003cp\u003e备份完成后的存储路径\u003ccode\u003e%USERPROFILE%\\Apple\\MobileSync\\Backup\u003c/code\u003e下的设备UDID文件夹中。\u003c/p\u003e","title":"手机取证"},{"content":"\rSulv\u0026#39;s Blog\r一个记录技术、阅读、生活的博客\r👉友链格式\r名称： Sulv\u0026rsquo;s Blog 网址： https://www.sulvblog.cn 图标： https://www.sulvblog.cn/img/Q.gif 描述： 一个记录技术、阅读、生活的博客 👉友链申请要求\r秉承互换友链原则、文章定期更新、不能有太多广告、个人描述字数控制在15字内\n👉Hugo博客交流群\r787018782\n","permalink":"https://dshh-sec.github.io/links/","summary":"\u003cdiv class=\"friend\"\u003e\r\n\u003ca target=\"_blank\" href=https://www.sulvblog.cn title=Sulv\u0026#39;s\u0026#32;Blog class=\"friendurl\"\u003e\r\n  \u003cdiv class=\"frienddiv\"\u003e\r\n    \u003cdiv class=\"frienddivleft\"\u003e\r\n      \u003cimg class=\"myfriend\" src=https://www.sulvblog.cn/img/Q.gif /\u003e\r\n    \u003c/div\u003e\r\n    \u003cdiv class=\"frienddivright\"\u003e\r\n      \u003cdiv class=\"friendname\"\u003eSulv\u0026#39;s Blog\u003c/div\u003e\r\n      \u003cdiv class=\"friendinfo\"\u003e一个记录技术、阅读、生活的博客\u003c/div\u003e\r\n    \u003c/div\u003e\r\n  \u003c/div\u003e\r\n\u003c/a\u003e\r\n\n\u003c/div\u003e\r\n\u003cbr/\u003e\r\n\u003cbr/\u003e\r\n\u003cbr/\u003e\r\n\u003cbr/\u003e\r\n\u003cbr/\u003e\r\n\u003cdiv style=\"font-size: 20px;\" class=\"youlian\"\u003e👉友链格式\u003c/div\u003e\r\n\u003cdiv style=\"font-size: 16px;\"\u003e\r\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth style=\"text-align: left\"\u003e\u003c/th\u003e\n          \u003cth style=\"text-align: left\"\u003e\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: left\"\u003e名称：\u003c/td\u003e\n          \u003ctd style=\"text-align: left\"\u003eSulv\u0026rsquo;s Blog\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: left\"\u003e网址：\u003c/td\u003e\n          \u003ctd style=\"text-align: left\"\u003e\u003ca href=\"https://www.sulvblog.cn\"\u003ehttps://www.sulvblog.cn\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: left\"\u003e图标：\u003c/td\u003e\n          \u003ctd style=\"text-align: left\"\u003e\u003ca href=\"https://www.sulvblog.cn/img/Q.gif\"\u003ehttps://www.sulvblog.cn/img/Q.gif\u003c/a\u003e\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: left\"\u003e描述：\u003c/td\u003e\n          \u003ctd style=\"text-align: left\"\u003e一个记录技术、阅读、生活的博客\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003c/div\u003e\r\n\u003cbr/\u003e\r\n\u003cdiv style=\"font-size: 20px;\"\u003e👉友链申请要求\u003c/div\u003e\r\n\u003cblockquote\u003e\n\u003cp\u003e秉承互换友链原则、文章定期更新\u003c!-- 、网站在工信部备案 --\u003e、不能有太多广告、个人描述字数控制在15字内\u003c/p\u003e","title":"🤝友链"},{"content":"关于我\n英文名: Kevin Xu 职业: 程序员 运动: 跑步、乒乓球、爬山 ","permalink":"https://dshh-sec.github.io/about/","summary":"\u003cp style=\"font-size: 25px;\"\u003e关于我\u003c/p\u003e\r\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth style=\"text-align: left\"\u003e\u003c/th\u003e\n          \u003cth style=\"text-align: left\"\u003e\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: left\"\u003e英文名:\u003c/td\u003e\n          \u003ctd style=\"text-align: left\"\u003eKevin Xu\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: left\"\u003e职业:\u003c/td\u003e\n          \u003ctd style=\"text-align: left\"\u003e程序员\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: left\"\u003e运动:\u003c/td\u003e\n          \u003ctd style=\"text-align: left\"\u003e跑步、乒乓球、爬山\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e","title":"🙋🏻‍♂️关于"},{"content":"ASDADSD测试 ADASD测试\nASDA测试 ADASD测试 SDASD测试\nASDASDAS测试\n","permalink":"https://dshh-sec.github.io/posts/test/","summary":"\u003ch1 id=\"asdadsd测试\"\u003eASDADSD测试\u003c/h1\u003e\n\u003cp\u003e\u003cem\u003eADASD测试\u003c/em\u003e\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eASDA测试\u003c/li\u003e\n\u003c/ol\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" style=\"color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan style=\"display:flex;\"\u003e\u003cspan\u003eADASD测试\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003e\u003ccode\u003eSDASD测试\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eASDASDAS测试\u003c/p\u003e\n\u003cp\u003e\u003cimg loading=\"lazy\" src=\"test.assets/image-20240920154939633.png\" alt=\"image-20240920154939633\"  /\u003e\r\n\u003c/p\u003e","title":"测试文档"}]